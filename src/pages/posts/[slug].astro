---
import SinglePost from '../../layouts/SinglePost.astro'
import { contentfulClient } from "../../lib/contentful";
import { documentToHtmlString } from '@contentful/rich-text-html-renderer'
import type { BlogPost } from "../../lib/contentful";

export async function getStaticPaths() {
  const entries = await contentfulClient.getEntries<BlogPost>({
    content_type: 'blogPost'
  })
  const pages = entries.items.map((item) => ({
    params: { slug: item.fields.slug },
    props: {
      title: item.fields.title,
      content: documentToHtmlString(item.fields.content),
      date: new Date(item.fields.date).toLocaleDateString(),
    }
  }))
  return pages
}

const { content, title, date } = Astro.props

---

<SinglePost title={`${title}`}>
  <main class="py-8 px-8  w-full">
    <div>
      <div class="text-left">
        <h1 class="text-3xl">{title}</h1>
        <time class="mt-2 text-gray-300 text-m">{date}</time>
      </div>
      <div class="mt-5">
        <article set:html={content} />
      </div>
    </div>
  </main>
</SinglePost>


